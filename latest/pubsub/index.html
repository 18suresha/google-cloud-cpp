<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google Cloud Pub/Sub C++ Client: Cloud Pub/Sub C++ Client Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Google Cloud Pub/Sub C++ Client
   &#160;<span id="projectnumber">0.0.0(dev)</span>
   </div>
   <div id="projectbrief">A C++ Client Library for Google Cloud Pub/Sub</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Cloud Pub/Sub C++ Client Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Cloud Pusb/Sub C++ Client library offers types and functions to use Cloud Pub/Sub from C++11 applications.</p>
<p>This library requires a C++11 compiler. It is supported (and tested) on multiple Linux distributions, macOS, and Windows.</p>
<h2>Quickstart</h2>
<p>The following instructions show you how to perform basic tasks in Cloud Pub/Sub using the C++ client library.</p>
<h3>Before you begin</h3>
<ol type="1">
<li>Select or create a Google Cloud Platform (GCP) project using the <a href="https://console.cloud.google.com/cloud-resource-manager" title="Console Resource Manager">manage resource page</a>. Make a note of the project id as you will need to use it later.</li>
<li>Make sure that <a href="https://cloud.google.com/billing/docs/how-to/modify-project" title="How to: Modify Project">billing is enabled</a> for your project.</li>
<li>Learn about <a href="https://cloud.google.com/pubsub/docs/concepts" title="Pub/Sub Concepts">key terms and concepts</a> for Cloud Pub/Sub.</li>
<li>Setup the authentication for the examples:<ul>
<li><a href="https://cloud.google.com/sdk/docs/authorizing" title="Authorizing Cloud SDK tools">Configure a service account</a>,</li>
<li>or <a href="https://cloud.google.com/sdk/docs/authorizing" title="Authorizing Cloud SDK tools">login with your personal account</a></li>
</ul>
</li>
</ol>
<h3>Setting up your repo</h3>
<p>In order to use the Cloud Pub/Sub C++ client library from your own code, you'll need to configure your build system how to fetch and compile the Cloud C++ client library. The Cloud Pub/Sub C++ client library natively supports the <a href="https://bazel.build/">Bazel</a> and <a href="https://cmake.org/">CMake</a> build systems. We've created a minimal, "Hello world", <a href="https://github.com/googleapis/google-cloud-cpp/blob/master/google/cloud/pubsub/quickstart">quickstart repo</a> that includes detailed instructions on how to compile the library for use in your application. You can fetch the source from <a href="https://github.com/googleapis/google-cloud-cpp" title="GitHub Repository">GitHub</a> as normal:</p>
<div class="fragment"><div class="line">git clone https://github.com/googleapis/google-cloud-cpp.git</div><div class="line">cd google-cloud-cpp/google/cloud/pubsub/quickstart</div></div><!-- fragment --><dl class="section user"><dt>Example: Hello World</dt><dd></dd></dl>
<p>The following shows the code that you'll run in the <code>google/cloud/pubsub/quickstart/</code> directory, which should give you a taste of the Cloud Pub/Sub C++ client library API.</p>
<div class="fragment"><div class="line"><span class="comment">// Copyright 2020 Google LLC</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><span class="comment">// you may not use this file except in compliance with the License.</span></div><div class="line"><span class="comment">// You may obtain a copy of the License at</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><span class="comment">// See the License for the specific language governing permissions and</span></div><div class="line"><span class="comment">// limitations under the License.</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="publisher_8h.html">google/cloud/pubsub/publisher.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdexcept&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="quickstart_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) <span class="keyword">try</span> {</div><div class="line">  <span class="keywordflow">if</span> (argc != 3) {</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; &lt;project-id&gt; &lt;topic-id&gt;\n&quot;</span>;</div><div class="line">    <span class="keywordflow">return</span> 1;</div><div class="line">  }</div><div class="line"></div><div class="line">  std::string <span class="keyword">const</span> project_id = argv[1];</div><div class="line">  std::string <span class="keyword">const</span> topic_id = argv[2];</div><div class="line"></div><div class="line">  <span class="comment">// Create a namespace alias to make the code easier to read.</span></div><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">pubsub</a> = <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">google::cloud::pubsub</a>;</div><div class="line">  <span class="keyword">auto</span> publisher = pubsub::Publisher(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a52843c207d3a785cc60eb1631527ad06">pubsub::MakePublisherConnection</a>(pubsub::Topic(project_id, topic_id), {}));</div><div class="line">  <span class="keyword">auto</span> <span class="keywordtype">id</span> =</div><div class="line">      publisher</div><div class="line">          .Publish(pubsub::MessageBuilder{}.SetData(<span class="stringliteral">&quot;Hello World!&quot;</span>).Build())</div><div class="line">          .get();</div><div class="line">  <span class="keywordflow">if</span> (!<span class="keywordtype">id</span>) <span class="keywordflow">throw</span> std::runtime_error(<span class="keywordtype">id</span>.status().message());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Hello World published with id=&quot;</span> &lt;&lt; *<span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">} <span class="keywordflow">catch</span> (std::exception <span class="keyword">const</span>&amp; ex) {</div><div class="line">  std::cerr &lt;&lt; <span class="stringliteral">&quot;Standard exception raised: &quot;</span> &lt;&lt; ex.what() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">  <span class="keywordflow">return</span> 1;</div><div class="line">}</div></div><!-- fragment --><h2>API Notes</h2>
<p>The following are general notes about using the library.</p>
<h3>Environment Variables</h3>
<p>There are several environment variables that can be set to configure certain behaviors in the library.</p>
<ul>
<li><code>GOOGLE_CLOUD_CPP_ENABLE_CLOG=yes</code> turns on logging in the library, basically the library always "logs" but the logging infrastructure has no backend to actually print anything until the application sets a backend or they set this environment variable.</li>
<li><code>GOOGLE_CLOUD_CPP_ENABLE_TRACING=rpc</code> turns on tracing for most gRPC calls. The library injects an additional Stub decorator that prints each gRPC request and response.</li>
<li><code>GOOGLE_CLOUD_CPP_TRACING_OPTIONS=...</code> modifies the behavior of gRPC tracing, including whether messages will be output on multiple lines, or whether string/bytes fields will be truncated.</li>
<li><code>GOOGLE_CLOUD_PROJECT=...</code> is used in examples and integration tests to configure the GCP project.</li>
<li><code>PUBSUB_EMULATOR_HOST=host:port</code> tells the library to connect to the specified emulator rather than the default endpoint.</li>
</ul>
<h3>Error Handling</h3>
<p>This library never throws exceptions to signal error. In general, the library returns a <a href="https://github.com/googleapis/google-cloud-cpp/blob/master/google/cloud/status_or.h"><code>StatusOr&lt;T&gt;</code></a> if an error is possible. Some functions return objects that are not wrapped in a <code>StatusOr&lt;&gt;</code> but will themselves return a <code>StatusOr&lt;T&gt;</code> to signal an error. For example, wrappers for asynchronous operations return <code>future&lt;StatusOr&lt;T&gt;&gt;</code>.</p>
<dl class="section user"><dt>Example</dt><dd></dd></dl>
<p>Applications should check if the <code>StatusOr&lt;T&gt;</code> contains a value before using it, much like how you might check that a pointer is not null before dereferencing it. Indeed, a <code>StatusOr&lt;T&gt;</code> object can be used like a smart-pointer to <code>T</code>, with the main difference being that when it does not hold a <code>T</code> it will instead hold a <code>Status</code> object with extra information about the error.</p>
<p>You can check that a <code>StatusOr&lt;T&gt;</code> contains a value by calling the <code>.ok()</code> method, or by using <code>operator bool()</code> (like with other smart pointers). If there is no value, you can access the contained <code>Status</code> object using the <code>.status()</code> member. If there is a value, you may access it by dereferencing with <code>operator*()</code> or <code>operator-&gt;()</code>. As with all smart pointers, callers must first check that the <code>StatusOr&lt;T&gt;</code> contains a value before dereferencing and accessing the contained value. Alternatively, callers may instead use the <code>.value()</code> member function which is defined to throw a <code>RuntimeStatusError</code> if there is no value.</p>
<dl class="section note"><dt>Note</dt><dd>If you're compiling with exceptions disabled, calling <code>.value()</code> on a <code>StatusOr&lt;T&gt;</code> that does not contain a value will terminate the program instead of throwing.</dd></dl>
<div class="fragment"><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">pubsub</a> = ::google::cloud::pubsub;</div><div class="line">  [](pubsub::TopicAdminClient client, std::string <span class="keyword">const</span>&amp; project_id) {</div><div class="line">    <span class="comment">// The actual type of `topic` is</span></div><div class="line">    <span class="comment">// google::cloud::StatusOr&lt;google::pubsub::v1::Topic&gt;, but</span></div><div class="line">    <span class="comment">// we expect it&#39;ll most often be declared with auto like this.</span></div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; topic : client.ListTopics(project_id)) {</div><div class="line">      <span class="comment">// Use `topic` like a smart pointer; check it before de-referencing</span></div><div class="line">      <span class="keywordflow">if</span> (!topic) {</div><div class="line">        <span class="comment">// `topic` doesn&#39;t contain a value, so `.status()` will contain error</span></div><div class="line">        <span class="comment">// info</span></div><div class="line">        std::cerr &lt;&lt; topic.status() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">      }</div><div class="line">      std::cout &lt;&lt; topic-&gt;DebugString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    }</div><div class="line">  }</div></div><!-- fragment --> <h2>Next Steps</h2>
<ul>
<li><a class="el" href="publisher-mock.html">Testing your Cloud Pub/Sub publisher application with googlemock</a></li>
<li><a class="el" href="subscriber-mock.html">Testing your Cloud Pub/Sub subscriber application with googlemock</a> </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
