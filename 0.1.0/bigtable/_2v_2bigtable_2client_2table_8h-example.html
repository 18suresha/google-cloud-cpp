<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google Cloud Bigtable C++ Client: /v/bigtable/client/table.h</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Google Cloud Bigtable C++ Client
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">A C++ Client Library for Google Cloud Bigtable</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/v/bigtable/client/table.h</div>  </div>
</div><!--header-->
<div class="contents">
<p>Attempts to apply mutations to multiple rows.</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mut</td><td>the mutations, note that this function takes ownership (and then discards) the data in the mutation. In general, a <code>BulkMutation</code> can modify multiple rows, and the modifications for each row can change (or create) multiple cells, across different columns and column families.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">PermanentMutationFailure</td><td>based on how the retry policy handles error conditions. Note that not idempotent mutations that are not reported as successful or failed by the server are not sent to the server more than once, and are reported back with a OK status in the exception. The exception contains a copy of the original mutations, in case the application wants to retry, log, or otherwise handle the failed mutations.</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> BulkApply(bigtable::Table&amp; table) {</div><div class="line">  <span class="comment">// Write several rows in a single operation, each row has some trivial data.</span></div><div class="line">  bigtable::BulkMutation bulk;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != 5000; ++i) {</div><div class="line">    <span class="comment">// Note: This example uses sequential numeric IDs for simplicity, but</span></div><div class="line">    <span class="comment">// this can result in poor performance in a production application.</span></div><div class="line">    <span class="comment">// Since rows are stored in sorted order by key, sequential keys can</span></div><div class="line">    <span class="comment">// result in poor distribution of operations across nodes.</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// For more information about how to design a Bigtable schema for the</span></div><div class="line">    <span class="comment">// best performance, see the documentation:</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">//     https://cloud.google.com/bigtable/docs/schema-design</span></div><div class="line">    <span class="keywordtype">char</span> buf[32];</div><div class="line">    snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;key-%06d&quot;</span>, i);</div><div class="line">    bigtable::SingleRowMutation mutation(buf);</div><div class="line">    mutation.emplace_back(</div><div class="line">        <a name="a0"></a><a class="code" href="namespacebigtable_1_1v0.html#aef996eb933092af76b2709fc37b70e36">bigtable::SetCell</a>(<span class="stringliteral">&quot;fam&quot;</span>, <span class="stringliteral">&quot;col0&quot;</span>, <span class="stringliteral">&quot;value0-&quot;</span> + std::to_string(i)));</div><div class="line">    mutation.emplace_back(</div><div class="line">        <a class="code" href="namespacebigtable_1_1v0.html#aef996eb933092af76b2709fc37b70e36">bigtable::SetCell</a>(<span class="stringliteral">&quot;fam&quot;</span>, <span class="stringliteral">&quot;col1&quot;</span>, <span class="stringliteral">&quot;value2-&quot;</span> + std::to_string(i)));</div><div class="line">    mutation.emplace_back(</div><div class="line">        <a class="code" href="namespacebigtable_1_1v0.html#aef996eb933092af76b2709fc37b70e36">bigtable::SetCell</a>(<span class="stringliteral">&quot;fam&quot;</span>, <span class="stringliteral">&quot;col2&quot;</span>, <span class="stringliteral">&quot;value3-&quot;</span> + std::to_string(i)));</div><div class="line">    mutation.emplace_back(</div><div class="line">        <a class="code" href="namespacebigtable_1_1v0.html#aef996eb933092af76b2709fc37b70e36">bigtable::SetCell</a>(<span class="stringliteral">&quot;fam&quot;</span>, <span class="stringliteral">&quot;col3&quot;</span>, <span class="stringliteral">&quot;value4-&quot;</span> + std::to_string(i)));</div><div class="line">    bulk.emplace_back(std::move(mutation));</div><div class="line">  }</div><div class="line">  table.BulkApply(std::move(bulk));</div><div class="line">}</div></div><!-- fragment --> <div class="fragment"><div class="line"><span class="comment">// Copyright 2017 Google Inc.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><span class="comment">// you may not use this file except in compliance with the License.</span></div><div class="line"><span class="comment">// You may obtain a copy of the License at</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><span class="comment">// See the License for the specific language governing permissions and</span></div><div class="line"><span class="comment">// limitations under the License.</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef GOOGLE_CLOUD_CPP_BIGTABLE_CLIENT_TABLE_H_</span></div><div class="line"><span class="preprocessor">#define GOOGLE_CLOUD_CPP_BIGTABLE_CLIENT_TABLE_H_</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;bigtable/client/internal/table.h&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacebigtable.html">bigtable</a> {</div><div class="line"><span class="keyword">inline</span> <span class="keyword">namespace </span><a name="a1"></a><a class="code" href="version_8h.html#aebb4d9f586ac64a412e3302f8a4b1c37">BIGTABLE_CLIENT_NS</a> {</div><div class="line"><span class="keyword">class </span>Table {</div><div class="line"> <span class="keyword">public</span>:</div><div class="line">  Table(std::shared_ptr&lt;DataClient&gt; client, std::string <span class="keyword">const</span>&amp; table_id)</div><div class="line">      : impl_(std::move(client), table_id) {}</div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> RPCRetryPolicy, <span class="keyword">typename</span> RPCBackoffPolicy,</div><div class="line">            <span class="keyword">typename</span> IdempotentMutationPolicy&gt;</div><div class="line">  Table(std::shared_ptr&lt;DataClient&gt; client, std::string <span class="keyword">const</span>&amp; table_id,</div><div class="line">        RPCRetryPolicy retry_policy, RPCBackoffPolicy backoff_policy,</div><div class="line">        IdempotentMutationPolicy idempotent_mutation_policy)</div><div class="line">      : impl_(std::move(client), table_id, std::move(retry_policy),</div><div class="line">              std::move(backoff_policy),</div><div class="line">              std::move(idempotent_mutation_policy)) {}</div><div class="line"></div><div class="line">  std::string <span class="keyword">const</span>&amp; table_name()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> impl_.table_name(); }</div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> Apply(SingleRowMutation&amp;&amp; mut);</div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> BulkApply(BulkMutation&amp;&amp; mut);</div><div class="line"></div><div class="line">  RowReader ReadRows(RowSet row_set, Filter filter);</div><div class="line"></div><div class="line">  RowReader ReadRows(RowSet row_set, std::int64_t rows_limit, Filter filter);</div><div class="line"></div><div class="line">  std::pair&lt;bool, Row&gt; ReadRow(std::string row_key, Filter filter);</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> CheckAndMutateRow(std::string row_key, Filter filter,</div><div class="line">                         std::vector&lt;Mutation&gt; true_mutations,</div><div class="line">                         std::vector&lt;Mutation&gt; false_mutations);</div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">template</span> &lt;<span class="keyword">typename</span>...&gt; <span class="keyword">class </span>Collection = std::vector&gt;</div><div class="line">  Collection&lt;bigtable::RowKeySample&gt; SampleRows() {</div><div class="line">    grpc::Status status;</div><div class="line">    <span class="keyword">auto</span> result = impl_.SampleRows&lt;Collection&gt;(status);</div><div class="line">    <span class="keywordflow">if</span> (not status.ok()) {</div><div class="line">      internal::RaiseRpcError(status, status.error_message());</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> result;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line">  Row ReadModifyWriteRow(std::string row_key,</div><div class="line">                         bigtable::ReadModifyWriteRule rule, Args&amp;&amp;... rules) {</div><div class="line">    grpc::Status status;</div><div class="line">    Row row =</div><div class="line">        impl_.ReadModifyWriteRow(std::move(row_key), status, std::move(rule),</div><div class="line">                                 std::forward&lt;Args&gt;(rules)...);</div><div class="line">    <span class="keywordflow">if</span> (not status.ok()) {</div><div class="line">      internal::RaiseRpcError(status, status.error_message());</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> row;</div><div class="line">  }</div><div class="line"></div><div class="line"> <span class="keyword">private</span>:</div><div class="line">  noex::Table impl_;</div><div class="line">};</div><div class="line"></div><div class="line">}  <span class="comment">// namespace BIGTABLE_CLIENT_NS</span></div><div class="line">}  <span class="comment">// namespace bigtable</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif  // GOOGLE_CLOUD_CPP_BIGTABLE_CLIENT_TABLE_H_</span></div></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
