<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google Cloud Bigtable C++ Client: Example: C++ Hello World Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Google Cloud Bigtable C++ Client
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">A C++ Client Library for Google Cloud Bigtable</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example: C++ Hello World Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example is a very simple "hello world" application, written in C++, that illustrates how to:</p>
<ul>
<li>Connect to a Cloud Bigtable instance.</li>
<li>Create a new table.</li>
<li>Write data to the table.</li>
<li>Read the data back.</li>
<li>Delete the table.</li>
</ul>
<h2>Running the example</h2>
<p>This example uses the <a href="https://GoogleCloudPlatform.github.io/google-cloud-cpp">Cloud Bigtable C++ Client Library</a> to communicate with Cloud Bigtable.</p>
<p>To run the example program, follow the <a href="https://github.com/GoogleCloudPlatform/google-cloud-cpp/tree/master/bigtable/examples/">instructions</a> for the example on GitHub.</p>
<h3>Including the Necessary Headers</h3>
<p>The example uses the following headers:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="table_8h.html">bigtable/client/table.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="table__admin_8h.html">bigtable/client/table_admin.h</a>&quot;</span></div></div><!-- fragment --> <h3>Connecting to Cloud Bigtable to manage tables</h3>
<p>To manage tables, connect to Cloud Bigtable using <code><a class="el" href="namespacebigtable_1_1v0.html#a47ed425d2e8281836e0222e8993b828c" title="Create a new admin client configured via options. ">bigtable::CreateDefaultAdminClient()</a></code>:</p>
<div class="fragment"><div class="line">  bigtable::TableAdmin table_admin(</div><div class="line">      <a class="code" href="namespacebigtable_1_1v0.html#a47ed425d2e8281836e0222e8993b828c">bigtable::CreateDefaultAdminClient</a>(project_id, bigtable::ClientOptions()),</div><div class="line">      instance_id);</div></div><!-- fragment --> <h3>Creating a table</h3>
<p>Create a table with <code>bigtable::TableAdmin::CreateTable()</code>:</p>
<div class="fragment"><div class="line">  <span class="comment">// Define the desired schema for the Table.</span></div><div class="line">  <span class="keyword">auto</span> gc_rule = bigtable::GcRule::MaxNumVersions(1);</div><div class="line">  bigtable::TableConfig schema({{<span class="stringliteral">&quot;family&quot;</span>, gc_rule}}, {});</div><div class="line"></div><div class="line">  <span class="comment">// Create a table.</span></div><div class="line">  <span class="keyword">auto</span> returned_schema = table_admin.CreateTable(table_id, schema);</div></div><!-- fragment --> <dl class="section see"><dt>See also</dt><dd><code><a class="el" href="classbigtable_1_1v0_1_1TableAdmin.html" title="Implements the API to administer tables instance a Cloud Bigtable instance. ">bigtable::v0::TableAdmin</a></code> for additional operations to list, read, modify, and delete tables.</dd></dl>
<h3>Connecting to Cloud Bigtable to manage data</h3>
<p>To manage data, connect to Cloud Bigtable using <code><a class="el" href="namespacebigtable_1_1v0.html#af479e95a27d852df7e5cad07cbeab7e9" title="Create the default implementation of ClientInterface. ">bigtable::CreateDefaultDataClient()</a></code>:</p>
<div class="fragment"><div class="line">  bigtable::Table table(<a class="code" href="namespacebigtable_1_1v0.html#af479e95a27d852df7e5cad07cbeab7e9">bigtable::CreateDefaultDataClient</a>(</div><div class="line">                            project_id, instance_id, bigtable::ClientOptions()),</div><div class="line">                        table_id);</div></div><!-- fragment --> <h3>Writing Rows to a table</h3>
<p>Then write the data:</p>
<div class="fragment"><div class="line">  std::vector&lt;std::string&gt; greetings{<span class="stringliteral">&quot;Hello World!&quot;</span>, <span class="stringliteral">&quot;Hello Cloud Bigtable!&quot;</span>,</div><div class="line">                                     <span class="stringliteral">&quot;Hello C++!&quot;</span>};</div><div class="line">  <span class="keywordtype">int</span> i = 0;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; greeting : greetings) {</div><div class="line">    <span class="comment">// Each row has a unique row key.</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// Note: This example uses sequential numeric IDs for simplicity, but</span></div><div class="line">    <span class="comment">// this can result in poor performance in a production application.</span></div><div class="line">    <span class="comment">// Since rows are stored in sorted order by key, sequential keys can</span></div><div class="line">    <span class="comment">// result in poor distribution of operations across nodes.</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// For more information about how to design a Bigtable schema for the</span></div><div class="line">    <span class="comment">// best performance, see the documentation:</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">//     https://cloud.google.com/bigtable/docs/schema-design</span></div><div class="line">    std::string row_key = <span class="stringliteral">&quot;key-&quot;</span> + std::to_string(i);</div><div class="line">    table.Apply(bigtable::SingleRowMutation(</div><div class="line">        std::move(row_key), <a class="code" href="namespacebigtable_1_1v0.html#aef996eb933092af76b2709fc37b70e36">bigtable::SetCell</a>(<span class="stringliteral">&quot;family&quot;</span>, <span class="stringliteral">&quot;c0&quot;</span>, greeting)));</div><div class="line">    ++i;</div><div class="line">  }</div></div><!-- fragment --> <dl class="section see"><dt>See also</dt><dd><code><a class="el" href="classbigtable_1_1v0_1_1Table.html#a5714f0f923da7544cccd11fa943f320b" title="Attempts to apply mutations to multiple rows. ">bigtable::v0::Table::BulkApply()</a></code> to modify multiple rows in a single operation. In addition to <code><a class="el" href="namespacebigtable_1_1v0.html#aef996eb933092af76b2709fc37b70e36" title="Create a mutation to set a cell value. ">SetCell()</a></code> there are functions to delete columns (e.g., <code><a class="el" href="namespacebigtable_1_1v0.html#a85e807d3730c0f25481c960147f2e409" title="Create a mutation to delete all the cells in a column family. ">DeleteFromFamily()</a></code>) or to delete the whole row (<code><a class="el" href="namespacebigtable_1_1v0.html#afd8f1d9efa4b470295cba73b2c52172d" title="Create a mutation to delete all the cells in a row. ">DeleteFromRow()</a></code>).</dd></dl>
<h3>Reading a row by its key</h3>
<p>Get a row directly using its key with <code>bigtable::Table::ReadRow()</code>:</p>
<div class="fragment"><div class="line">  <span class="keyword">auto</span> result = table.ReadRow(</div><div class="line">      <span class="stringliteral">&quot;key-0&quot;</span>, bigtable::Filter::ColumnRangeClosed(<span class="stringliteral">&quot;family&quot;</span>, <span class="stringliteral">&quot;c0&quot;</span>, <span class="stringliteral">&quot;c0&quot;</span>));</div><div class="line">  <span class="keywordflow">if</span> (not result.first) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cannot find row &#39;key-0&#39; in the table: &quot;</span> &lt;&lt; table.table_name()</div><div class="line">              &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">  }</div><div class="line">  <span class="keyword">auto</span> <span class="keyword">const</span>&amp; cell = result.second.cells().front();</div><div class="line">  std::cout &lt;&lt; cell.family_name() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; cell.column_qualifier() &lt;&lt; <span class="stringliteral">&quot;    @ &quot;</span></div><div class="line">            &lt;&lt; cell.timestamp() &lt;&lt; <span class="stringliteral">&quot;us\n&quot;</span></div><div class="line">            &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; cell.value() &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; std::endl;</div></div><!-- fragment --> <dl class="section see"><dt>See also</dt><dd><code><a class="el" href="classbigtable_1_1v0_1_1Filter.html" title="Define the interfaces to create filter expressions. ">bigtable::v0::Filter</a></code> to filter the column families, columns, and even the timestamps returned by <code>ReadRow()</code>. </dd>
<dd>
<code><a class="el" href="classbigtable_1_1v0_1_1Table.html#a07bf1327a1e247881ae98537e722812d" title="Reads a set of rows from the table. ">bigtable::v0::Table::ReadRows()</a></code> to iterate over multiple rows.</dd></dl>
<h3>Scanning all table rows</h3>
<p>Use <code>bigtable::Table::ReadRows()</code> to scan all of the rows in a table.</p>
<div class="fragment"><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; row : table.ReadRows(bigtable::RowRange::InfiniteRange(),</div><div class="line">                                  bigtable::Filter::PassAllFilter())) {</div><div class="line">    std::cout &lt;&lt; row.row_key() &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span>;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; cell : row.cells()) {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; cell.family_name() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; cell.column_qualifier()</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;    @ &quot;</span> &lt;&lt; cell.timestamp() &lt;&lt; <span class="stringliteral">&quot;us\n&quot;</span></div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;\t\&quot;&quot;</span> &lt;&lt; cell.value() &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line">  }</div></div><!-- fragment --> <dl class="section see"><dt>See also</dt><dd><code><a class="el" href="classbigtable_1_1v0_1_1RowRange.html" title="Define the interfaces to create row key ranges. ">bigtable::v0::RowRange</a></code> to scan only a portion of the table.</dd></dl>
<h3>Deleting a table</h3>
<p>Delete a table with <code>TableAdmin::DeleteTable</code>.</p>
<div class="fragment"><div class="line">  table_admin.DeleteTable(table_id);</div></div><!-- fragment --> <h2>Putting it all together</h2>
<p>Here is the full example</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="table_8h.html">bigtable/client/table.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="table__admin_8h.html">bigtable/client/table_admin.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) <span class="keyword">try</span> {</div><div class="line">  <span class="keywordflow">if</span> (argc != 4) {</div><div class="line">    std::string <span class="keyword">const</span> cmd = argv[0];</div><div class="line">    <span class="keyword">auto</span> last_slash = std::string(cmd).find_last_of(<span class="charliteral">&#39;/&#39;</span>);</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; cmd.substr(last_slash + 1)</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; &lt;project_id&gt; &lt;instance_id&gt; &lt;table_id&gt;&quot;</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> 1;</div><div class="line">  }</div><div class="line"></div><div class="line">  std::string <span class="keyword">const</span> project_id = argv[1];</div><div class="line">  std::string <span class="keyword">const</span> instance_id = argv[2];</div><div class="line">  std::string <span class="keyword">const</span> table_id = argv[3];</div><div class="line"></div><div class="line">  <span class="comment">// Connect to the Cloud Bigtable Admin API.</span></div><div class="line"><span class="comment"></span>  bigtable::TableAdmin table_admin(</div><div class="line">      <a class="code" href="namespacebigtable_1_1v0.html#a47ed425d2e8281836e0222e8993b828c">bigtable::CreateDefaultAdminClient</a>(project_id, bigtable::ClientOptions()),</div><div class="line">      instance_id);</div><div class="line"></div><div class="line">  <span class="comment">// Define the desired schema for the Table.</span></div><div class="line">  <span class="keyword">auto</span> gc_rule = bigtable::GcRule::MaxNumVersions(1);</div><div class="line">  bigtable::TableConfig schema({{<span class="stringliteral">&quot;family&quot;</span>, gc_rule}}, {});</div><div class="line"></div><div class="line">  <span class="comment">// Create a table.</span></div><div class="line">  <span class="keyword">auto</span> returned_schema = table_admin.CreateTable(table_id, schema);</div><div class="line"></div><div class="line">  <span class="comment">// Create an object to access the Cloud Bigtable Data API.</span></div><div class="line"><span class="comment"></span>  bigtable::Table table(<a class="code" href="namespacebigtable_1_1v0.html#af479e95a27d852df7e5cad07cbeab7e9">bigtable::CreateDefaultDataClient</a>(</div><div class="line">                            project_id, instance_id, bigtable::ClientOptions()),</div><div class="line">                        table_id);</div><div class="line"></div><div class="line">  <span class="comment">// Modify (and create if necessary) a row.</span></div><div class="line"><span class="comment"></span>  std::vector&lt;std::string&gt; greetings{<span class="stringliteral">&quot;Hello World!&quot;</span>, <span class="stringliteral">&quot;Hello Cloud Bigtable!&quot;</span>,</div><div class="line">                                     <span class="stringliteral">&quot;Hello C++!&quot;</span>};</div><div class="line">  <span class="keywordtype">int</span> i = 0;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; greeting : greetings) {</div><div class="line">    <span class="comment">// Each row has a unique row key.</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// Note: This example uses sequential numeric IDs for simplicity, but</span></div><div class="line">    <span class="comment">// this can result in poor performance in a production application.</span></div><div class="line">    <span class="comment">// Since rows are stored in sorted order by key, sequential keys can</span></div><div class="line">    <span class="comment">// result in poor distribution of operations across nodes.</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// For more information about how to design a Bigtable schema for the</span></div><div class="line">    <span class="comment">// best performance, see the documentation:</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">//     https://cloud.google.com/bigtable/docs/schema-design</span></div><div class="line">    std::string row_key = <span class="stringliteral">&quot;key-&quot;</span> + std::to_string(i);</div><div class="line">    table.Apply(bigtable::SingleRowMutation(</div><div class="line">        std::move(row_key), <a class="code" href="namespacebigtable_1_1v0.html#aef996eb933092af76b2709fc37b70e36">bigtable::SetCell</a>(<span class="stringliteral">&quot;family&quot;</span>, <span class="stringliteral">&quot;c0&quot;</span>, greeting)));</div><div class="line">    ++i;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Read a single row.</span></div><div class="line"><span class="comment"></span>  <span class="keyword">auto</span> result = table.ReadRow(</div><div class="line">      <span class="stringliteral">&quot;key-0&quot;</span>, bigtable::Filter::ColumnRangeClosed(<span class="stringliteral">&quot;family&quot;</span>, <span class="stringliteral">&quot;c0&quot;</span>, <span class="stringliteral">&quot;c0&quot;</span>));</div><div class="line">  <span class="keywordflow">if</span> (not result.first) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cannot find row &#39;key-0&#39; in the table: &quot;</span> &lt;&lt; table.table_name()</div><div class="line">              &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">  }</div><div class="line">  <span class="keyword">auto</span> <span class="keyword">const</span>&amp; cell = result.second.cells().front();</div><div class="line">  std::cout &lt;&lt; cell.family_name() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; cell.column_qualifier() &lt;&lt; <span class="stringliteral">&quot;    @ &quot;</span></div><div class="line">            &lt;&lt; cell.timestamp() &lt;&lt; <span class="stringliteral">&quot;us\n&quot;</span></div><div class="line">            &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; cell.value() &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="comment">// Read a single row.</span></div><div class="line"><span class="comment"></span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; row : table.ReadRows(bigtable::RowRange::InfiniteRange(),</div><div class="line">                                  bigtable::Filter::PassAllFilter())) {</div><div class="line">    std::cout &lt;&lt; row.row_key() &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span>;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; cell : row.cells()) {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; cell.family_name() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; cell.column_qualifier()</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;    @ &quot;</span> &lt;&lt; cell.timestamp() &lt;&lt; <span class="stringliteral">&quot;us\n&quot;</span></div><div class="line">                &lt;&lt; <span class="stringliteral">&quot;\t\&quot;&quot;</span> &lt;&lt; cell.value() &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Delete the table</span></div><div class="line"><span class="comment"></span>  table_admin.DeleteTable(table_id);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">} <span class="keywordflow">catch</span> (std::exception <span class="keyword">const</span>&amp; ex) {</div><div class="line">  std::cerr &lt;&lt; <span class="stringliteral">&quot;Standard C++ exception raised: &quot;</span> &lt;&lt; ex.what() &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 1;</div><div class="line">}</div></div><!-- fragment --></div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
